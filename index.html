<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGEUL - Astana Monitoring Map</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #0b0d11; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        #map { height: 100vh; width: 100%; }
        
        /* –õ–æ–≥–æ—Ç–∏–ø—Ç–µ—Ä–¥—ñ ”©—à—ñ—Ä—É */
        .leaflet-control-attribution { display: none !important; }

        /* –î–∏–∑–∞–π–Ω –ø–∞–Ω–µ–ª—ñ */
        .ui-card {
            position: absolute; top: 15px; left: 15px; z-index: 1000;
            background: rgba(15, 23, 42, 0.9); padding: 15px; border-radius: 10px;
            border: 1px solid #38bdf8; width: 220px; color: white;
            box-shadow: 0 5px 20px rgba(0,0,0,0.6);
        }

        /* –°–µ—Ä–≥–µ–∫ - BAQ.KZ —Å—Ç–∏–ª—ñ–Ω–¥–µ–≥—ñ –∂–∞—Ä“õ—ã—Ä–∞“ì–∞–Ω “õ—ã–∑—ã–ª –Ω“Ø–∫—Ç–µ–ª–µ—Ä */
        .sergek-marker {
            background: #ff0000; border: 1.5px solid white; border-radius: 50%;
            box-shadow: 0 0 12px #ff0000;
        }

        /* –ê—è–ª–¥–∞–º–∞ - –ö”©–∫ –Ω“Ø–∫—Ç–µ–ª–µ—Ä */
        .stop-marker {
            background: #007aff; border: 1px solid white; border-radius: 50%;
            box-shadow: 0 0 5px #007aff;
        }

        /* –ê–≤—Ç–æ–±—É—Å - 2GIS —Å—Ç–∏–ª—ñ */
        .bus-icon { font-size: 24px; transition: all 1.5s linear; filter: drop-shadow(0 0 4px #fff); }
    </style>
</head>
<body>

<div class="ui-card">
    <h3 style="margin:0; font-size: 16px; color:#38bdf8;">SmartCity Monitoring</h3>
    <hr style="border: 0.5px solid #334155; margin: 10px 0;">
    <div style="font-size: 12px;">
        <p>‚Ä¢ –ö–∞–º–µ—Ä—ã Sergek: <span style="color:#ff4444; font-weight:bold;">100+ –∞–∫—Ç–∏–≤–Ω—ã</span></p>
        <p>‚Ä¢ –û—Å—Ç–∞–Ω–æ–≤–∫–∏: <span style="color:#38bdf8;">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã</span></p>
        <p>‚Ä¢ –ü—Ä–æ–µ–∫—Ç: <b>AGEUL</b></p>
    </div>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. –ö–∞—Ä—Ç–∞–Ω—ã –ê—Å—Ç–∞–Ω–∞–Ω—ã“£ –æ—Ä—Ç–∞—Å—ã–Ω–∞ “õ–æ—é (Zoom 13 - “õ–∞–ª–∞ –∫”©—Ä—ñ–Ω—É—ñ “Ø—à—ñ–Ω)
    const map = L.map('map', { zoomControl: false, attributionControl: false }).setView([51.135, 71.435], 13);

    // 2. –Ø–Ω–¥–µ–∫—Å –ª–æ–≥–æ—Ç–∏–ø—ñ –∂–æ“õ, —Ç–∞–∑–∞ “õ–∞—Ä–∞“£“ì—ã –∫”ô—Å—ñ–±–∏ –∫–∞—Ä—Ç–∞
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

    // 3. –°–µ—Ä–≥–µ–∫—Ç—ñ –∂–æ–ª –±–æ–π—ã–Ω–∞ 100-–¥–µ–Ω –∞—Å—ã—Ä—ã–ø —Ç—ñ–∑—É
    function spawnSergek(start, end, count) {
        for (let i = 0; i <= count; i++) {
            let lat = start[0] + (end[0] - start[0]) * (i / count);
            let lng = start[1] + (end[1] - start[1]) * (i / count);
            L.marker([lat, lng], {
                icon: L.divIcon({ className: 'sergek-marker', iconSize: [9, 9] })
            }).addTo(map);
        }
    }

    // –ë–ê–°–¢–´ –ñ–û–õ–î–ê–†“í–ê –¢–Ü–ó–£ (100+ —à—Ç—É–∫)
    spawnSergek([51.127, 71.425], [51.100, 71.500], 30); // –ú”ô“£–≥—ñ–ª—ñ–∫ –ï–ª
    spawnSergek([51.145, 71.405], [51.120, 71.470], 30); // “ö–∞–±–∞–Ω–±–∞–π –ë–∞—Ç—ã—Ä
    spawnSergek([51.155, 71.415], [51.135, 71.460], 25); // –¢“±—Ä–∞–Ω
    spawnSergek([51.170, 71.430], [51.140, 71.440], 20); // –°–∞—Ä—ã–∞—Ä“õ–∞/–†–µ—Å–ø—É–±–ª–∏–∫–∞

    // 4. –ê–Ø–õ–î–ê–ú–ê–õ–ê–† (–ñ–æ–ª –±–æ–π—ã–Ω–¥–∞“ì—ã –∫”©–∫ –Ω“Ø–∫—Ç–µ–ª–µ—Ä)
    const roadStops = [
        [51.138, 71.418], [51.135, 71.430], [51.132, 71.443], [51.129, 71.455],
        [51.144, 71.413], [51.141, 71.425], [51.138, 71.438], [51.135, 71.450],
        [51.122, 71.440], [51.118, 71.455], [51.114, 71.470]
    ];
    roadStops.forEach(pos => {
        L.marker(pos, { icon: L.divIcon({ className: 'stop-marker', iconSize: [8, 8] }) }).addTo(map);
    });

    // 5. –ê–í–¢–û–ë–£–°–¢–ê–† (–ù–∞“õ—Ç—ã –º–∞—Ä—à—Ä—É—Ç–ø–µ–Ω –∂—ã–ª–∂—É)
    function animateBus(route, emoji) {
        const marker = L.marker(route[0], { 
            icon: L.divIcon({ html: emoji, className: 'bus-icon', iconSize: [30, 30] }) 
        }).addTo(map);
        
        let step = 0;
        setInterval(() => {
            step = (step + 1) % route.length;
            marker.setLatLng(route[step]);
        }, 1500);
    }

    // –¢“±—Ä–∞–Ω –∂”ô–Ω–µ “ö–∞–±–∞–Ω–±–∞–π –±–æ–π—ã–º–µ–Ω –∞–≤—Ç–æ–±—É—Å—Ç–∞—Ä
    animateBus([[51.144, 71.413], [51.141, 71.425], [51.138, 71.438], [51.135, 71.450]], 'üöå');
    animateBus([[51.138, 71.418], [51.135, 71.430], [51.132, 71.443], [51.129, 71.455]], 'üöê');

</script>
</body>
</html>

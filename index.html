<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ "Smart City"</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        body { margin: 0; padding: 0; font-family: 'Arial', sans-serif; background: #0b0d11; color: #fff; }
        #map { height: 100vh; width: 100%; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∑–Ω–∞—á–∫–æ–≤ */
        .sergek-icon {
            background: #ff0000;
            border: 2px solid white;
            border-radius: 50%;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            color: white;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(255,0,0,0.7);
        }
        
        .bus-icon {
            font-size: 24px;
            transition: all 0.5s linear; /* –ü–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ */
        }

        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .ui-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(15, 23, 42, 0.9);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #334155;
            width: 280px;
        }

        h2 { margin-top: 0; font-size: 18px; color: #38bdf8; }
        .status-item { margin-bottom: 10px; font-size: 14px; display: flex; justify-content: space-between; }
        .dot { height: 10px; width: 10px; border-radius: 50%; display: inline-block; background: #22c55e; }
    </style>
</head>
<body>

<div class="ui-panel">
    <h2>–°–ï–†–ì–ï–ö: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</h2>
    <div class="status-item"><span>–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:</span> <span style="color: #22c55e;">ONLINE <span class="dot"></span></span></div>
    <div class="status-item"><span>–ö–∞–º–µ—Ä –≤ —Å–µ—Ç–∏:</span> <span>124</span></div>
    <div class="status-item"><span>–ú–∞—Ä—à—Ä—É—Ç –ê-–°:</span> <span style="color: #38bdf8;">–ê–∫—Ç–∏–≤–µ–Ω</span></div>
    <hr style="border: 0.5px solid #334155;">
    <p style="font-size: 12px; color: #94a3b8;">* –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞–º–µ—Ä—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞—Ä—Ö–∏–≤–∞.</p>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã (–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ê—Å—Ç–∞–Ω–∞)
    const map = L.map('map', { zoomControl: false }).setView([51.147, 71.430], 14);

    // 2. –£–±–∏—Ä–∞–µ–º –Ø–Ω–¥–µ–∫—Å, —Å—Ç–∞–≤–∏–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Ç–µ–º–Ω—É—é –ø–æ–¥–ª–æ–∂–∫—É
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: 'Smart City Data'
    }).addTo(map);

    // 3. –§–µ–π–∫–æ–≤—ã–π —Å–∏–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç (–¢–æ—á–∫–∞ –ê -> –¢–æ—á–∫–∞ –°)
    const routeCoords = [
        [51.155, 71.410], // –¢–æ—á–∫–∞ –ê
        [51.150, 71.425],
        [51.145, 71.440],
        [51.140, 71.460]  // –¢–æ—á–∫–∞ –°
    ];
    const polyline = L.polyline(routeCoords, {
        color: '#0070f3', 
        weight: 6, 
        opacity: 0.8,
        dashArray: '10, 10' // –ü—É–Ω–∫—Ç–∏—Ä –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã
    }).addTo(map);

    // –ü–æ–¥–ø–∏—Å–∏ –ê –∏ –°
    L.marker([51.155, 71.410]).addTo(map).bindTooltip("–¢–æ—á–∫–∞ –ê", {permanent: true});
    L.marker([51.140, 71.460]).addTo(map).bindTooltip("–¢–æ—á–∫–∞ –°", {permanent: true});

    // 4. –ó–Ω–∞—á–∫–∏ –°–ï–†–ì–ï–ö (–ö–∞–º–µ—Ä—ã)
    const cameraLocations = [
        [51.152, 71.420],
        [51.146, 71.435],
        [51.142, 71.450]
    ];

    cameraLocations.forEach((loc, index) => {
        const sergekIcon = L.divIcon({
            className: 'sergek-icon',
            html: 'S', 
            iconSize: [20, 20]
        });
        L.marker(loc, {icon: sergekIcon}).addTo(map)
            .bindPopup(<b>–ö–∞–º–µ—Ä–∞ –°–µ—Ä–≥–µ–∫ ID: 00${index+1}</b><br>–°–∫–æ—Ä–æ—Å—Ç—å: 60 –∫–º/—á);
    });

    // 5. –ê–≤—Ç–æ–±—É—Å–Ω—ã–µ –∑–Ω–∞—á–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ–∑–¥—è—Ç —Å–∞–º–∏
    const bus1Coords = [
        [51.140, 71.420], [51.145, 71.425], [51.150, 71.430], [51.155, 71.435]
    ];
    
    const busIcon = L.divIcon({ html: 'üöå', className: 'bus-icon', iconSize: [30, 30] });
    const busMarker = L.marker(bus1Coords[0], { icon: busIcon }).addTo(map);

    let busStep = 0;
    function moveBus() {
        busStep = (busStep + 1) % bus1Coords.length;
        busMarker.setLatLng(bus1Coords[busStep]);
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
    setInterval(moveBus, 3000);

</script>
</body>
</html>

<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGEUL - Astana Smart Transport</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #0b0d11; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        #map { height: 100vh; width: 100%; background: #0b0d11; }
        .leaflet-control-attribution { display: none !important; }

        /* 2GIS —Å—Ç–∏–ª—ñ–Ω–¥–µ–≥—ñ –∞–≤—Ç–æ–±—É—Å –º–∞—Ä–∫–µ—Ä—ñ */
        .bus-56-icon {
            background: #007aff; color: white; border: 2px solid white;
            border-radius: 20px; padding: 2px 8px; font-weight: bold;
            font-size: 12px; white-space: nowrap; display: flex; align-items: center;
            box-shadow: 0 0 10px rgba(0,122,255,0.8);
        }
        .bus-56-icon::before { content: 'üöå '; margin-right: 4px; }

        /* –°–µ—Ä–≥–µ–∫ - BAQ.KZ —Å—Ç–∏–ª—ñ–Ω–¥–µ–≥—ñ “õ—ã–∑—ã–ª –Ω“Ø–∫—Ç–µ–ª–µ—Ä */
        .sergek-node {
            background: #ff0000; border: 1px solid #fff; border-radius: 50%;
            box-shadow: 0 0 6px #ff0000;
        }

        /* –ê—è–ª–¥–∞–º–∞ –±–µ–ª–≥—ñ—Å—ñ */
        .stop-icon {
            background: rgba(255,255,255,0.2); border: 1.5px solid #38bdf8;
            border-radius: 50%; width: 10px; height: 10px;
        }

        /* –ê“õ–ø–∞—Ä–∞—Ç –ø–∞–Ω–µ–ª—ñ */
        .ui-overlay {
            position: absolute; top: 15px; left: 15px; z-index: 1000;
            background: rgba(15, 23, 42, 0.95); padding: 15px; border-radius: 10px;
            border: 1px solid #38bdf8; color: white; width: 220px;
        }
    </style>
</head>
<body>

<div class="ui-overlay">
    <h3 style="margin:0; color:#38bdf8;">AGEUL: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</h3>
    <p style="font-size:12px; margin:8px 0 0 0;">–ú–∞—Ä—à—Ä—É—Ç: <span style="color:#22c55e;">–ê–≤—Ç–æ–±—É—Å 56 (–ê–∫—Ç–∏–≤)</span></p>
    <p style="font-size:11px; color:#94a3b8;">–°–µ—Ä–≥–µ–∫ –∂“Ø–π–µ—Å—ñ: “ö–æ—Å—É–ª—ã</p>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // 1. –ö–∞—Ä—Ç–∞–Ω—ã –±–∞–ø—Ç–∞—É (2GIS —Å—Ç–∏–ª—ñ–Ω–¥–µ–≥—ñ “õ–∞—Ä–∞“£“ì—ã —Ñ–æ–Ω)
    const map = L.map('map', { zoomControl: false }).setView([51.130, 71.430], 14);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

    // 2. –°–ï–†–ì–ï–ö–¢–ï–†–î–Ü –ñ–û–õ –ë–û–ô–´–ù–ê –ñ“Æ–ô–ï–õ–Ü –¢“Æ–†–î–ï –®–ê–®–£ (100+)
    function placeSergeks(start, end, count) {
        for (let i = 0; i <= count; i++) {
            let lat = start[0] + (end[0] - start[0]) * (i / count);
            let lng = start[1] + (end[1] - start[1]) * (i / count);
            // –ñ–æ–ª–¥—ã“£ —à–µ—Ç—ñ–Ω–¥–µ —Ç“±—Ä—É—ã “Ø—à—ñ–Ω –∞–∑–¥–∞–ø –æ—Ñ—Å–µ—Ç
            L.marker([lat + 0.0001, lng + 0.0001], {
                icon: L.divIcon({ className: 'sergek-node', iconSize: [8, 8] })
            }).addTo(map);
        }
    }

    // –ù–µ–≥—ñ–∑–≥—ñ –¥–∞“£“ì—ã–ª–¥–∞—Ä –±–æ–π—ã–º–µ–Ω (“ö–∞–±–∞–Ω–±–∞–π, –¢“±—Ä–∞–Ω, –ú”ô“£–≥—ñ–ª—ñ–∫ –ï–ª, –°–∞—Ä—ã–∞—Ä“õ–∞)
    placeSergeks([51.145, 71.405], [51.120, 71.470], 35); 
    placeSergeks([51.155, 71.415], [51.135, 71.465], 30);
    placeSergeks([51.127, 71.425], [51.100, 71.500], 35);

    // 3. –ê–í–¢–û–ë–£–° 56 –ú–ê–†–®–†–£–¢–´ (–ù–∞“õ—Ç—ã –∂–æ–ª “õ–∏—Å—ã“õ—Ç–∞—Ä—ã–º–µ–Ω)
    const route56 = [
        [51.145, 71.405], [51.143, 71.415], [51.140, 71.422], 
        [51.135, 71.430], [51.130, 71.440], [51.125, 71.455], [51.122, 71.470]
    ];
    
    // –ö”©–∫ –±–∞“ì—ã—Ç—Ç–∞—É—à—ã —Å—ã–∑—ã“õ (2GIS-—Ç–µ–≥—ñ–¥–µ–π)
    L.polyline(route56, { color: '#007aff', weight: 5, opacity: 0.6 }).addTo(map);

    // –ê—è–ª–¥–∞–º–∞–ª–∞—Ä–¥—ã –∂–æ–ª –±–æ–π—ã–Ω–∞ “õ–æ—é
    route56.forEach(pos => {
        L.marker(pos, { icon: L.divIcon({ className: 'stop-icon', iconSize: [10, 10] }) }).addTo(map);
    });

    // 4. –¢–Ü–†–Ü –ê–í–¢–û–ë–£–° "56" (–ë–∞—è—É –∂”ô–Ω–µ –±—ñ—Ä“õ–∞–ª—ã–ø—Ç—ã “õ–æ–∑“ì–∞–ª—ã—Å)
    const busIcon = L.divIcon({ 
        className: 'bus-56-icon', 
        html: '56', 
        iconSize: [60, 25],
        iconAnchor: [30, 12]
    });

    const busMarker = L.marker(route56[0], { icon: busIcon }).addTo(map);

    let currentStep = 0;
    function moveBus() {
        currentStep = (currentStep + 1) % route56.length;
        
        // –ê–≤—Ç–æ–±—É—Å "—Ç—É–ø–∏—Ç" –µ—Ç–ø–µ—É—ñ “Ø—à—ñ–Ω –∂”ô–Ω–µ –∂—ã–ª–¥–∞–º –±–æ–ª–º–∞—É—ã “Ø—à—ñ–Ω –∂—ã–ª–∂—É –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
        busMarker.setLatLng(route56[currentStep]);
    }

    // –ê–≤—Ç–æ–±—É—Å –∂—ã–ª–¥–∞–º–¥—ã“ì—ã–Ω –±–∞—è—É–ª–∞—Ç—Ç—ã–º (”ô—Ä 3 —Å–µ–∫—É–Ω–¥ —Å–∞–π—ã–Ω –∫–µ–ª–µ—Å—ñ –Ω“Ø–∫—Ç–µ–≥–µ)
    setInterval(moveBus, 3000);

</script>
</body>
</html>

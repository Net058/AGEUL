<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>AGEUL - Astana Monitoring Full</title>
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: sans-serif; }
        #map { width: 100%; height: 100vh; }

        /* Төменгі панель (Сен жіберген скриншоттағыдай стиль) */
        #bottom-panel {
            position: absolute; bottom: -450px; left: 0; width: 100%;
            background: white; border-top-left-radius: 25px; border-top-right-radius: 25px;
            z-index: 2000; transition: bottom 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            padding: 20px; box-sizing: border-box;
            box-shadow: 0 -5px 25px rgba(0,0,0,0.4);
        }
        #bottom-panel.active { bottom: 0; }

        .panel-handle { width: 45px; height: 5px; background: #e0e0e0; margin: 0 auto 20px; border-radius: 10px; }
        .location-title { font-size: 22px; font-weight: bold; color: #1a1a1a; margin-bottom: 5px; }
        .location-desc { color: #70757a; font-size: 15px; margin-bottom: 20px; }
        
        .photo-container { width: 100%; height: 220px; background: #f0f0f0; border-radius: 15px; overflow: hidden; border: 1px solid #eee; }
        .photo-container img { width: 100%; height: 100%; object-fit: cover; }

        .close-btn { position: absolute; right: 25px; top: 25px; font-size: 28px; cursor: pointer; color: #dadce0; }
        
        /* AGEUL үстіңгі көрсеткіші */
        .ui-header {
            position: absolute; top: 20px; left: 20px; z-index: 1000;
            background: rgba(255, 255, 255, 0.9); padding: 12px 20px; border-radius: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2); font-weight: bold; display: flex; align-items: center; gap: 10px;
        }
        .dot { width: 10px; height: 10px; background: #ff3b30; border-radius: 50%; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<div class="ui-header">
    <div class="dot"></div>
    <span>AGEUL: 450+ Сергек активті</span>
</div>

<div id="bottom-panel">
    <div class="panel-handle"></div>
    <div class="close-btn" onclick="closePanel()">×</div>
    <div class="location-title" id="p-title">Dropped pin</div>
    <div class="location-desc" id="p-desc">Астана қаласы, Есіл ауданы</div>
    
    <div class="photo-container">
        <img id="p-img" src="https://images.unsplash.com/photo-1541339907198-e08756ebafe3?auto=format&fit=crop&w=800&q=80" alt="Street View">
    </div>
</div>

<div id="map"></div>

<script type="text/javascript">
    ymaps.ready(init);
    var myMap;

    function init() {
        myMap = new ymaps.Map("map", {
            center: [51.128, 71.430],
            zoom: 13,
            controls: ['trafficControl', 'zoomControl']
        });

        // 1. БАРЛЫҚ СЕРГЕКТЕРДІ ҚАЙТАРУ (450 нүкте)
        var clusterer = new ymaps.Clusterer({ preset: 'islands#redClusterIcons' });

        for (var i = 0; i < 450; i++) {
            var lat = 51.06 + (Math.random() * 0.16);
            var lng = 71.30 + (Math.random() * 0.25);
            
            var placemark = new ymaps.Placemark([lat, lng], {
                title: "Сергек бақылау нүктесі #" + (2000 + i),
                desc: "Астана, Нұржол желекжолы маңы",
                // Түрлі суреттер имитациясы
                img: i % 2 === 0 ? "https://images.unsplash.com/photo-1517733948473-28b5a1484b6a?auto=format&fit=crop&w=800" : "https://images.unsplash.com/photo-1449824913935-59a10b8d2000?auto=format&fit=crop&w=800"
            }, {
                preset: 'islands#redCircleDotIcon',
                iconColor: '#ff0000',
                iconScale: 0.8
            });

            // Әр нүктені басқанда панель шығады
            placemark.events.add('click', function (e) {
                var target = e.get('target');
                showInfo(target.properties.get('title'), target.properties.get('desc'), target.properties.get('img'));
            });

            myMap.geoObjects.add(placemark);
        }

        // Картаның өзін басқанда да панель шығару (Dropped pin эффектісі)
        myMap.events.add('click', function (e) {
            var coords = e.get('coords');
            showInfo("Таңдалған орын", "Координаттар: " + coords[0].toFixed(4) + ", " + coords[1].toFixed(4), "https://images.unsplash.com/photo-1566438480900-0609be27a4be?auto=format&fit=crop&w=800");
        });
    }

    function showInfo(title, desc, img) {
        document.getElementById('p-title').innerText = title;
        document.getElementById('p-desc').innerText = desc;
        document.getElementById('p-img').src = img;
        document.getElementById('bottom-panel').classList.add('active');
    }

    function closePanel() {
        document.getElementById('bottom-panel').classList.remove('active');
    }
</script>
</body>
</html>
